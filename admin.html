<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hacker Tapper Admin</title>
<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-database-compat.js"></script>
<style>
body{font-family:sans-serif;padding:10px;background:#020610;color:#fff}
table{width:100%;border-collapse:collapse}
th,td{padding:6px;border:1px solid #444;text-align:left}
button{padding:4px 8px;margin:2px;background:#00e5a8;color:#000;border:none;border-radius:4px;cursor:pointer}
</style>
</head>
<body>
<h2>Hacker Tapper Admin Panel</h2>
<button id="loadUsers">Load All Users</button>
<table id="usersTable">
<tr><th>Telegram ID</th><th>Username</th><th>Coins</th><th>Score</th><th>Action</th></tr>
</table>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBDovmAk88JUEjeY35T-3eIta1igiE5fQ0",
  authDomain: "comhashgame.firebaseapp.com",
  databaseURL: "https://comhashgame-default-rtdb.firebaseio.com",
  projectId: "comhashgame",
  storageBucket: "comhashgame.appspot.com",
  messagingSenderId: "392187080052",
  appId: "1:392187080052:web:3e31391442ca1315dc1021"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const table = document.getElementById('usersTable');

document.getElementById('loadUsers').onclick = async ()=>{
  table.innerHTML = '<tr><th>Telegram ID</th><th>Username</th><th>Coins</th><th>Score</th><th>Action</th></tr>';
  try {
    const snapshot = await db.ref('users').get();
    if (!snapshot.exists()) { alert('No users found'); return; }
    const users = snapshot.val();
    Object.keys(users).forEach(uid=>{
      const user = users[uid];
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${uid}</td>
        <td>${user.username || ''}</td>
        <td><input type="number" value="${user.coins||0}" style="width:60px"></td>
        <td>${user.score||0}</td>
        <td><button data-uid="${uid}">Update Coins</button></td>
      `;
      table.appendChild(tr);
      tr.querySelector('button').onclick = ()=>{
        const newCoins = Number(tr.querySelector('input').value);
        db.ref('users/' + uid + '/coins').set(newCoins)
          .then(()=>alert('Coins updated'))
          .catch(e=>alert('Error: '+e));
      };
    });
  } catch(e){
    alert('Load failed: '+e);
  }
};
</script>
</body>
</html>
